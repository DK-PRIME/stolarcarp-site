<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Live —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ ‚Äî STOLAR CARP</title>

  <!-- Favicon & App Icon -->
  <link rel="icon" type="image/png" href="assets/favicon.png">
  <link rel="apple-touch-icon" href="assets/favicon.png">
  <meta name="theme-color" content="#1a1a1a">

  <!-- –°—Ç–∏–ª—ñ —Ç–∞ —Å–∫—Ä–∏–ø—Ç –º–µ–Ω—é -->
  <link rel="stylesheet" href="assets/css/main.css">
  <script defer src="assets/js/config.js"></script>

  <!-- –õ–æ–∫–∞–ª—å–Ω—ñ —Å—Ç–∏–ª—ñ —Ç—ñ–ª—å–∫–∏ –¥–ª—è live-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ -->
  <style>
    .live-header {
      display:flex;
      flex-direction:column;
      gap:6px;
      margin-bottom:18px;
    }
    .live-kicker{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:.12em;
      color:#fcd34d;
      background:rgba(252,211,77,0.08);
      border-radius:999px;
      padding:4px 10px;
      border:1px solid rgba(252,211,77,0.35);
      width:fit-content;
    }
    .live-kicker span.live-dot{
      width:8px;height:8px;border-radius:50%;
      background:#ef4444;
      box-shadow:0 0 10px rgba(239,68,68,0.9);
    }
    .live-stage-pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:13px;
      color:var(--muted);
    }
    .live-stage-pill span{
      padding:4px 10px;
      border-radius:999px;
      border:1px solid #262636;
      background:#0d0d14;
      font-size:12px;
    }

    .title-gradient{
      background:linear-gradient(90deg,#f6c34c 0%,#cc6a2b 35%,#7a0f2b 100%);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }

    .live-layout{
      display:grid;
      grid-template-columns:2fr 1.2fr;
      gap:18px;
    }
    @media (max-width:900px){
      .live-layout{
        grid-template-columns:1fr;
      }
    }

    .live-zones-grid{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:12px;
    }
    @media (max-width:900px){
      .live-zones-grid{
        grid-template-columns:1fr;
      }
    }

    .live-zone-title{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:6px;
    }
    .live-zone-title span.badge{
      font-size:11px;
      padding:3px 8px;
    }

    .table-sm{
      font-size:13px;
    }
    .table-sm th,
    .table-sm td{
      padding:6px 8px;
      white-space:nowrap;
    }
    .table-sm td.team-col{
      max-width:180px;
      white-space:normal;
    }

    .live-note{
      font-size:12px;
      color:var(--muted);
      margin-top:6px;
    }

    .bigfish-row--max{
      background:rgba(250,204,21,0.08);
    }
  </style>
</head>
<body>

<!-- HEADER -->
<header class="header">
  <div class="container header__row">
    <a class="logo" href="index.html">
      <span class="logo__mark">SC</span>
      <span class="logo__text">STOLAR CARP</span>
    </a>
    <nav class="nav" id="nav">
      <a href="index.html" class="nav__link">–ì–æ–ª–æ–≤–Ω–∞</a>
      <a href="rules.html" class="nav__link">–†–µ–≥–ª–∞–º–µ–Ω—Ç</a>
      <a href="register.html" class="nav__link">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
      <a href="live.html" class="nav__link nav__link--active">Live</a>
      <a href="rating.html" class="nav__link">–†–µ–π—Ç–∏–Ω–≥</a>
      <a href="lakes.html" class="nav__link">–í–æ–¥–æ–π–º–∏</a>
      <a href="sponsors.html" class="nav__link">–°–ø–æ–Ω—Å–æ—Ä–∏</a>
      <a href="events/turnir-2026.html" class="nav__link">–¢—É—Ä–Ω—ñ—Ä 2026</a>
    </nav>
    <button class="burger" id="burger"><span></span><span></span><span></span></button>
  </div>
</header>

<!-- MAIN -->
<main class="main">
  <section class="container section">
    <div class="live-header">
      <div class="live-kicker">
        <span class="live-dot"></span>
        <span>Live –ø—Ä–æ—Ç–æ–∫–æ–ª</span>
      </div>
      <h1 class="title-gradient" style="margin:4px 0 4px;font-size:clamp(26px,4.5vw,34px);">
        –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –µ—Ç–∞–ø—É
      </h1>
      <div class="live-stage-pill">
        <span>–ü–æ—Ç–æ—á–Ω–∏–π –µ—Ç–∞–ø: <strong id="liveStageName">...</strong></span>
      </div>
      <p class="lead" style="max-width:640px;margin:4px 0 0;">
        –î–∞–Ω—ñ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è –∑ Google-—Ç–∞–±–ª–∏—Ü—ñ. –ü—ñ–¥—Å—É–º–∫–∏ —Ñ–æ—Ä–º—É—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ –∑–æ–Ω–∞—Ö A/B/C, 
        –∑–∞–≥–∞–ª—å–Ω—ñ–π –≤–∞–∑—ñ —Ç–∞ Big Fish.
      </p>
    </div>

    <div id="liveError" class="form-msg err" style="display:none;"></div>

    <div id="liveContent" class="live-layout" style="display:none;">
      <!-- –õ—ñ–≤–∞ –∫–æ–ª–æ–Ω–∫–∞: –∑–æ–Ω–∏ + –∑–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª -->
      <div class="live-left">
        <div class="card" style="margin-bottom:16px;">
          <h2 style="margin-top:0;margin-bottom:10px;">–ó–æ–Ω–∏ A / B / C</h2>
          <div class="live-zones-grid" id="zonesContainer">
            <!-- JS –≤—Å—Ç–∞–≤–∏—Ç—å 3 –∫–∞—Ä—Ç–∫–∏ –∑–æ–Ω -->
          </div>
          <p class="live-note">
            –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –ø–æ –≤–∞–∑—ñ, –ø—Ä–∏ —Ä—ñ–≤–Ω—ñ–π –≤–∞–∑—ñ ‚Äî –∑–∞ –Ω–∞–π–±—ñ–ª—å—à–æ—é —Ä–∏–±–æ—é (BIG).
          </p>
        </div>

        <div class="card">
          <h2 style="margin-top:0;margin-bottom:10px;">–ó–∞–≥–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è</h2>
          <div class="table-wrap" style="overflow-x:auto;">
            <table class="table table-sm" id="totalTable">
              <thead>
                <tr>
                  <th>‚Ññ</th>
                  <th>–ö–æ–º–∞–Ω–¥–∞</th>
                  <th>–ó–æ–Ω–∞</th>
                  <th>–ö-—Å—Ç—å</th>
                  <th>BIG</th>
                  <th>–í–∞–≥–∞</th>
                </tr>
              </thead>
              <tbody>
                <!-- JS -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- –ü—Ä–∞–≤–∞ –∫–æ–ª–æ–Ω–∫–∞: Big Fish Total -->
      <div class="live-right">
        <div class="card">
          <h2 style="margin-top:0;margin-bottom:10px;">Big Fish ‚Äî Total</h2>
          <div class="table-wrap" style="overflow-x:auto;">
            <table class="table table-sm" id="bigFishTable">
              <thead>
                <tr>
                  <th>–ö–æ–º–∞–Ω–¥–∞</th>
                  <th>BIG 1 –¥–æ–±–∞</th>
                  <th>BIG 2 –¥–æ–±–∞</th>
                  <th>MAX BIG</th>
                </tr>
              </thead>
              <tbody>
                <!-- JS -->
              </tbody>
            </table>
          </div>
          <p class="live-note">
            Big Fish –µ—Ç–∞–ø—É.
          </p>
        </div>
      </div>
    </div>

    <div id="liveLoading" class="form__hint" style="margin-top:12px;">
      –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤...
    </div>
  </section>
</main>

<!-- FOOTER -->
<footer class="footer">
  <div class="container footer__row">
    <div>¬© 2025 STOLAR CARP ¬∑ –õ—å–≤—ñ–≤</div>
    <div class="footer__links">
      <a href="https://invite.viber.com/?g=8R04gUEhdVSnX6sr_DxGGGqAXTus0Ygh">Viber</a>
      <a href="https://youtube.com/@dk-stolarcarp?si=H-BUK2msCiKXdcA9">YouTube</a>
    </div>
  </div>
</footer>

<!-- –°–ö–†–ò–ü–¢ LIVE-–ü–Ü–î–¢–Ø–ì–£–í–ê–ù–ù–Ø -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const apiUrl = 'https://script.google.com/macros/s/AKfycbzlJBi2eA8K2DpcJMcIBBbLFnX4YvDR11qy_UGKPYS2slzjHQ91jpYQBlT87fK1iVH2/exec?action=live';

  const stageEl   = document.getElementById('liveStageName');
  const zonesWrap = document.getElementById('zonesContainer');
  const totalTbody = document.querySelector('#totalTable tbody');
  const bigFishTbody = document.querySelector('#bigFishTable tbody');
  const loadingEl = document.getElementById('liveLoading');
  const contentEl = document.getElementById('liveContent');
  const errorEl   = document.getElementById('liveError');

  const fmt = (v) => {
    if (v === null || v === undefined || v === '') return '-';
    return String(v);
  };

  const renderZones = (zones) => {
    const zoneNames = ['A','B','C'];
    zonesWrap.innerHTML = zoneNames.map(z => {
      const list = zones[z] || [];
      if (!list.length){
        return `
          <div class="live-zone card">
            <div class="live-zone-title">
              <h3 style="margin:0;">–ó–æ–Ω–∞ ${z}</h3>
              <span class="badge">–Ω–µ–º–∞—î –¥–∞–Ω–∏—Ö</span>
            </div>
            <p class="form__hint">–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –¥–ª—è —Ü—ñ—î—ó –∑–æ–Ω–∏ —â–µ –Ω–µ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ.</p>
          </div>
        `;
      }

      const rowsHtml = list.map(row => `
        <tr>
          <td>${fmt(row.place)}</td>
          <td class="team-col">${fmt(row.team)}</td>
          <td>${fmt(row.count)}</td>
          <td>${fmt(row.big)}</td>
          <td>${fmt(row.weight)}</td>
        </tr>
      `).join('');

      return `
        <div class="live-zone card">
          <div class="live-zone-title">
            <h3 style="margin:0;">–ó–æ–Ω–∞ ${z}</h3>
            <span class="badge badge--warn">–∫–æ–º–∞–Ω–¥: ${list.length}</span>
          </div>
          <div class="table-wrap" style="overflow-x:auto;">
            <table class="table table-sm">
              <thead>
                <tr>
                  <th>‚Ññ</th>
                  <th>–ö–æ–º–∞–Ω–¥–∞</th>
                  <th>–ö-—Å—Ç—å</th>
                  <th>BIG</th>
                  <th>–í–∞–≥–∞</th>
                </tr>
              </thead>
              <tbody>
                ${rowsHtml}
              </tbody>
            </table>
          </div>
        </div>
      `;
    }).join('');
  };

  const renderTotal = (total) => {
    if (!total || !total.length){
      totalTbody.innerHTML = '<tr><td colspan="6">–î–∞–Ω—ñ —â–µ –Ω–µ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ.</td></tr>';
      return;
    }

    totalTbody.innerHTML = total.map(row => `
      <tr>
        <td>${fmt(row.place)}</td>
        <td class="team-col">${fmt(row.team)}</td>
        <td>${fmt(row.zone)}</td>
        <td>${fmt(row.count)}</td>
        <td>${fmt(row.big)}</td>
        <td>${fmt(row.weight)}</td>
      </tr>
    `).join('');
  };

  const renderBigFish = (list) => {
    if (!list || !list.length){
      bigFishTbody.innerHTML = '<tr><td colspan="4">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ Big Fish.</td></tr>';
      return;
    }

    bigFishTbody.innerHTML = list.map(row => `
      <tr class="${row.isMax ? 'bigfish-row--max' : ''}">
        <td>${fmt(row.team)}</td>
        <td>${fmt(row.big1Day)}</td>
        <td>${fmt(row.big2Day)}</td>
        <td><strong>${fmt(row.teamMaxBig)}</strong>${row.isMax ? ' üèÜ' : ''}</td>
      </tr>
    `).join('');
  };

  const loadLive = async () => {
    try {
      const res = await fetch(apiUrl);
      const json = await res.json();

      if (json && json.stage) {
        stageEl.textContent = json.stage;
      } else {
        stageEl.textContent = '‚Äî';
      }

      const data = json && json.data ? json.data : { zones:{A:[],B:[],C:[]}, total:[], bigFishTotal:[] };

      renderZones(data.zones || {A:[],B:[],C:[]});
      renderTotal(data.total || []);
      renderBigFish(data.bigFishTotal || []);

      if (loadingEl) loadingEl.style.display = 'none';
      if (contentEl) contentEl.style.display = 'grid';
    } catch (err) {
      console.error('Live fetch error:', err);
      if (errorEl){
        errorEl.style.display = 'block';
        errorEl.textContent = '‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ live-–¥–∞–Ω—ñ. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è ACTIVE_STAGE –∞–±–æ —Å–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.';
      }
      if (loadingEl) loadingEl.style.display = 'none';
    }
  };

  loadLive();
});
</script>

</body>
</html>
