<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Реєстрація змагань — STOLAR CARP</title>

  <link rel="icon" type="image/png" href="/assets/favicon.png">
  <link rel="apple-touch-icon" href="/assets/favicon.png">
  <meta name="theme-color" content="#1a1a1a">

  <!-- ✅ SPEED: швидший старт мережі під Firebase -->
  <link rel="dns-prefetch" href="https://www.gstatic.com">
  <link rel="preconnect" href="https://www.gstatic.com" crossorigin>

  <!-- ✅ SPEED: швидше підтягуються стилі -->
  <link rel="preload" href="/assets/css/main.css" as="style">
  <link rel="stylesheet" href="/assets/css/main.css">

  <!-- ✅ SPEED: Firebase завантажується раніше, але НЕ блокує HTML (defer зберігає порядок) -->
  <script defer src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js"></script>

  <!-- ✅ ВАЖЛИВО: init Firebase ПІСЛЯ firebase-compat, але ДО логіки сторінки -->
  <script defer src="/assets/js/firebase-init.js"></script>

  <!-- твій конфіг (бургер/хедер/іконки тощо) -->
  <script defer src="/assets/js/config.js"></script>

  <!-- логіка реєстрації -->
  <script defer src="/assets/js/register_firebase.js"></script>

  <style>
    body.register-page{background:var(--bg); overflow-x:hidden;}
    .section--narrow{max-width:1100px;margin:0 auto;}

    .register-hero{
      margin-top:14px;margin-bottom:22px;padding:18px 16px 16px;border-radius:16px;
      background:linear-gradient(145deg,#14141d,#08080d);border:1px solid #262636;
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .register-hero__kicker{
      font-size:.72rem;text-transform:uppercase;letter-spacing:.18em;
      color:var(--muted);margin-bottom:6px;display:flex;align-items:center;gap:8px;
    }
    .register-hero__kicker-tag{
      display:inline-flex;align-items:center;justify-content:center;
      width:22px;height:22px;border-radius:999px;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      font-weight:800;font-size:.75rem;color:#000;
      box-shadow:0 0 8px rgba(0,0,0,.7);
      flex:0 0 auto;
    }
    .register-hero h1{
      margin:0 0 8px;font-size:clamp(22px,3.4vw,28px);
      font-weight:900;letter-spacing:.06em;text-transform:uppercase;
      line-height:1.15;
    }
    .register-hero .title-gradient{
      background:linear-gradient(90deg,#f6c34c 0%,#cc6a2b 40%,#7a0f2b 100%);
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    .register-hero p{margin:0;color:var(--muted);font-size:.92rem;max-width:720px;}
    .register-hero__divider{
      margin-top:10px;width:120px;height:2px;border-radius:999px;
      background:linear-gradient(90deg,#f6c34c 0%,#cc6a2b 50%,#7a0f2b 100%);
      box-shadow:0 0 10px rgba(246,195,76,.5);
    }

    /* ✅ ЗГОРТАННЯ ОПИСУ (стиль не ламаємо) */
    .details-wrap{margin-top:10px;max-width:860px;}
    .details-wrap details{
      border:1px solid rgba(148,163,184,.18);
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
      border-radius:14px;
      padding:10px 12px;
    }
    .details-wrap summary{
      cursor:pointer;
      font-weight:900;
      letter-spacing:.04em;
      text-transform:uppercase;
      color:#e5e7eb;
      font-size:.82rem;
      list-style:none;
    }
    .details-wrap summary::-webkit-details-marker{display:none;}
    .details-wrap .details-body{
      margin-top:10px;
      color:var(--muted);
      font-size:.92rem;
      line-height:1.6;
    }

    .register-layout{
      display:grid;
      grid-template-columns:minmax(0,2fr) minmax(0,1.1fr);
      gap:18px;align-items:flex-start;
    }
    @media (max-width:860px){.register-layout{grid-template-columns:1fr;}}

    .register-form-card h2{
      margin:0 0 6px;
      font-size:1.05rem;
      text-transform:uppercase;
      letter-spacing:.08em;
    }
    .form__hint{font-size:.8rem;color:var(--muted);}

    .field{display:grid;gap:6px;margin-bottom:12px;}
    .field label{font-size:.9rem;font-weight:600;}
    #foodQtyField.field--disabled{opacity:.55;}

    .register-page input[type="number"]{
      background:#0f0f14;border:1px solid #2a2a39;color:#fff;
      padding:10px 14px;border-radius:12px;font-size:.96rem;
      width:100%;
    }
    .register-page input::placeholder{color:#6b7280;}
    .register-page input:focus{
      outline:none;border-color:var(--accent);
      box-shadow:0 0 10px rgba(246,195,76,0.35);
    }

    .radio-row{display:flex;flex-wrap:wrap;gap:16px;}
    .radio-row label{display:inline-flex;align-items:center;gap:8px;cursor:pointer;font-size:.92rem;}

    .form-actions{display:flex;align-items:center;gap:10px;margin-top:4px;flex-wrap:wrap;}
    .spinner{
      width:18px;height:18px;border-radius:50%;
      border:3px solid rgba(255,255,255,.2);border-top-color:#fff;
      display:none;
    }
    .spinner--on{display:inline-block;animation:spin .9s linear infinite;}
    @keyframes spin{to{transform:rotate(360deg)}}
    .form-msg{margin-top:6px;font-weight:700;font-size:.92rem;}
    .form-msg.ok{color:#43d18a;}
    .form-msg.err{color:#ff6c6c;}

    .profile-summary{font-size:.85rem;color:var(--muted);margin-bottom:10px;}
    .profile-summary b{color:#e5e7eb;}

    .card--payment{background:#05060c;border:1px solid #262636;box-shadow:var(--shadow);}
    .card-payment-title{
      font-weight:800;margin-bottom:6px;display:flex;align-items:center;gap:8px;
      text-transform:uppercase;font-size:.84rem;letter-spacing:.12em;color:#e5e7eb;
    }
    .card-payment-title span{
      width:20px;height:20px;border-radius:50%;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      display:inline-flex;align-items:center;justify-content:center;
      font-size:.9rem;color:#000;font-weight:900;
    }
    .card-number{
      font-weight:800;letter-spacing:.16em;padding:10px 12px;border-radius:12px;
      background:#020308;border:1px solid #33384a;display:inline-block;
      margin:4px 0;font-size:.92rem;
      max-width:100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .card-note{font-size:.8rem;color:var(--muted);margin-top:6px;}

    .event-options{
      display:flex;
      flex-direction:column;
      gap:10px;
      padding:10px;
      border-radius:16px;
      border:1px solid rgba(148,163,184,.18);
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
      overflow:hidden;
      max-width:100%;
    }

    .event-item{
      position:relative;
      display:flex;
      gap:10px;
      align-items:flex-start;
      padding:12px 12px;
      border-radius:14px;
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(148,163,184,.22);
      box-shadow:0 10px 26px rgba(0,0,0,.35);
      transition:transform .12s ease, border-color .2s ease, box-shadow .2s ease;
      width:100%;
      max-width:100%;
      box-sizing:border-box;
      overflow:hidden;
    }
    .event-item:hover{
      transform:translateY(-1px);
      border-color:rgba(246,195,76,.55);
      box-shadow:0 14px 34px rgba(0,0,0,.45);
    }
    .event-item input[type="radio"]{
      width:18px;height:18px;
      accent-color:var(--accent);
      margin-top:2px;
      flex:0 0 auto;
    }

    .event-content{min-width:0;flex:1;}
    .event-title{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      font-weight:900;
      letter-spacing:.02em;
      line-height:1.2;
    }
    .event-title .text{
      min-width:0;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .event-meta{
      margin-top:6px;
      font-size:12px;
      color:var(--muted);
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .event-badges{
      display:flex;
      gap:6px;
      flex-wrap:wrap;
      justify-content:flex-end;
      flex:0 0 auto;
    }

    .pill-b{
      font-size:11px;
      padding:5px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.25);
      background:rgba(2,6,23,.55);
      color:#e5e7eb;
      white-space:nowrap;
      font-weight:900;
    }

    .pill-b--stage{   background:rgba(59,130,246,.16);  border-color:rgba(59,130,246,.35);  color:#bfe0ff; }
    .pill-b--final{   background:linear-gradient(135deg,#f6c34c,#cc6a2b,#7a0f2b); border-color:transparent; color:#120a00; }
    .pill-b--oneoff{  background:rgba(168,85,247,.16);  border-color:rgba(168,85,247,.35);  color:#efd6ff; }
    .pill-b--stalker{ background:rgba(239,68,68,.16);   border-color:rgba(239,68,68,.35);   color:#ffb4b4; }

    .pill-b--open{
      background:linear-gradient(135deg,#22c55e,#16a34a);
      border-color:transparent;
      color:#04110a;
    }
    .pill-b--closed{
      background:rgba(239,68,68,.15);
      border-color:rgba(239,68,68,.35);
      color:#ffb4b4;
    }
    .pill-b--active{
      background:rgba(246,195,76,.16);
      border-color:rgba(246,195,76,.35);
      color:#ffe7a6;
    }

    .event-item.is-closed{opacity:.6; filter:saturate(.9);}
    .event-item.is-closed:hover{transform:none; box-shadow:0 10px 26px rgba(0,0,0,.35);}

    @media (max-width:520px){
      .register-hero{padding:16px 14px;}
      .card{padding:16px;}
      .event-options{padding:10px;}
      .event-item{padding:12px 10px;}
      .event-title .text{max-width:220px;}
    }
  </style>
</head>

<body class="register-page">

<header class="header">
  <div class="container header__row">
    <a class="logo" href="/index.html">
      <span class="logo__mark">SC</span>
      <span class="logo__text">STOLAR CARP</span>
    </a>

    <nav class="nav" id="nav">
      <a href="/index.html" class="nav__link">Головна</a>
      <a href="/rules.html" class="nav__link">Регламент</a>
      <a href="/formats.html" class="nav__link">Формат змагань</a>
      <a href="/register.html" class="nav__link nav__link--active">Реєстрація</a>
      <a href="/live.html" class="nav__link">Live</a>
      <a href="/rating.html" class="nav__link">Рейтинг</a>
      <a href="/lakes.html" class="nav__link">Водойми</a>
      <a href="/sponsors.html" class="nav__link">Спонсори</a>
      <a href="/events/index.html" class="nav__link">Архів</a>
      <a href="#" class="nav__link" id="goCabinet">Мій кабінет</a>
    </nav>

    <button class="burger" id="burger"><span></span><span></span><span></span></button>
  </div>
</header>

<main class="main">
  <section class="container section section--narrow">

    <div class="register-hero">
      <div class="register-hero__kicker">
        <span class="register-hero__kicker-tag">SC</span>
        STOLAR CARP · REGISTRATION
      </div>
      <h1 class="title-gradient"><span>РЕЄСТРАЦІЯ ЗМАГАНЬ STOLAR CARP</span></h1>
      <p>Оберіть відкрите змагання/етап, налаштуйте харчування — і подайте заявку.</p>

      <!-- ✅ ОПИС ЗГОРНУТИЙ -->
      <div class="details-wrap">
        <details>
          <summary>Детальніше</summary>
          <div class="details-body">
            Тут можна розмістити весь розширений опис/правила реєстрації (весь текст лишається, просто згорнутий).
            Після подачі заявки участь підтверджується після оплати внеску. У коментарі до платежу обовʼязково
            вкажіть назву команди.
          </div>
        </details>
      </div>

      <div class="register-hero__divider"></div>
    </div>

    <div class="register-layout">

      <div class="card register-form-card">
        <h2>ФОРМА РЕЄСТРАЦІЇ</h2>
        <p class="form__hint">Поля з позначкою <span style="color:var(--accent);">*</span> є обовʼязковими.</p>

        <div id="profileSummary" class="profile-summary">Профіль: завантаження...</div>

        <form id="regForm" class="form" novalidate>
          <input type="text" name="hp" id="hp" autocomplete="off"
                 style="position:absolute;left:-9999px;top:-9999px;height:0;width:0;opacity:0;"/>

          <div class="field">
            <label>Оберіть змагання / етап <span style="color:var(--accent);">*</span></label>
            <div id="eventOptions" class="event-options">
              <p class="form__hint">Завантаження списку...</p>
            </div>
          </div>

          <div class="field">
            <label>Харчування<span style="color:var(--accent);">*</span></label>
            <div class="radio-row">
              <label><input type="radio" name="food" value="Так" required> <span>Так</span></label>
              <label><input type="radio" name="food" value="Ні"> <span>Ні</span></label>
            </div>
          </div>

          <div class="field field--disabled" id="foodQtyField">
            <label for="food_qty">Кількість харчуючих (1–6)</label>
            <input type="number" id="food_qty" name="food_qty" min="1" max="6" inputmode="numeric"
                   placeholder="Вкажіть кількість, якщо замовляєте харчування" disabled />
            <div class="form__hint">Якщо харчування не потрібне — залиште поле порожнім.</div>
          </div>

          <div class="field">
            <label style="display:flex;align-items:center;gap:10px;cursor:pointer;">
              <input type="checkbox" id="rules" required style="transform:scale(1.25);accent-color:#f6c34c;">
              <span>Підтверджую, що ознайомлений із
                <a href="/rules.html" target="_blank" style="color:#f6c34c;text-decoration:underline;">регламентом турніру</a>
              </span>
            </label>
          </div>

          <div class="form-actions">
            <button type="submit" id="submitBtn" class="btn btn--primary" disabled>Подати заявку</button>
            <div id="spinner" class="spinner" aria-hidden="true"></div>
          </div>

          <div id="msg" class="form-msg"></div>

          <p class="form__hint" style="margin-top:6px;">
            Після подачі заявки участь підтверджується після оплати внеску.
          </p>
        </form>
      </div>

      <div class="card register-card card--payment" id="payCard">
        <div class="card-payment-title"><span>₴</span> Оплата внеску</div>

        <p id="payLine">
          Сума внеску: <b><span id="payAmount">—</span> <span id="payCurrency">UAH</span></b> на банківську картку:
        </p>

        <p id="payLabel">Реквізити:</p>
        <p><span id="cardNum" class="card-number">—</span></p>

        <button type="button" id="copyCard" class="btn btn--ghost" style="margin-top:6px;">
          Скопіювати реквізити
        </button>

        <p class="card-note" id="payNote">
          У коментарі до платежу обовʼязково вкажіть <b>назву команди</b>.
        </p>
      </div>

    </div>
  </section>
</main>

<footer class="footer">
  <div class="container footer__row">
    <div>© 2025 STOLAR CARP · Львів</div>
    <div class="footer__links">
      <a href="https://invite.viber.com/?g=8R04gUEhdVSnX6sr_DxGGGqAXTus0Ygh">Viber</a>
      <a href="https://youtube.com/@dk-stolarcarp?si=H-BUK2msCiKXdcA9">YouTube</a>
    </div>
  </div>
</footer>

</body>
</html>
