<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è ‚Äî STOLAR CARP</title>
  <link rel="stylesheet" href="assets/css/main.css" />
  <script defer src="assets/js/config.js"></script>
  <style>
    /* —Å—Ç–∏–ª—å –¥–ª—è –≤–∏–±–æ—Ä—É –ø–æ–¥—ñ—ó */
    .event-options{display:flex;flex-direction:column;gap:8px;margin-bottom:18px}
    .event-item{background:#15161a;border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:10px 14px;color:#fff;display:flex;align-items:center;gap:10px;font-size:1rem;cursor:pointer;transition:.2s}
    .event-item:hover{background:#1c1d22}
    .event-item input[type="radio"]{accent-color:#ffb300;transform:scale(1.2)}
    .field--disabled{opacity:.6}
  </style>
</head>

<body class="register-page">
<header class="header">
  <div class="container header__row">
    <a class="logo" href="index.html">
      <span class="logo__mark">SC</span>
      <span class="logo__text">STOLAR CARP</span>
    </a>
    <nav class="nav" id="nav">
      <a href="index.html" class="nav__link">–ì–æ–ª–æ–≤–Ω–∞</a>
      <a href="rules.html" class="nav__link">–†–µ–≥–ª–∞–º–µ–Ω—Ç</a>
      <a href="register.html" class="nav__link nav__link--active">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
      <a href="live.html" class="nav__link">Live</a>
      <a href="rating.html" class="nav__link">–†–µ–π—Ç–∏–Ω–≥</a>
      <a href="lakes.html" class="nav__link">–í–æ–¥–æ–π–º–∏</a>
      <a href="sponsors.html" class="nav__link">–°–ø–æ–Ω—Å–æ—Ä–∏</a>
      <a href="events/turnir-2026.html" class="nav__link">–¢—É—Ä–Ω—ñ—Ä 2026</a>
    </nav>
    <button class="burger" id="burger"><span></span><span></span><span></span></button>
  </div>
</header>

<main class="main">
  <section class="container section section--narrow">
    <h1 class="page-title title-gradient">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ–º–∞–Ω–¥</h1>
    <p class="lead">–ó–∞–ø–æ–≤–Ω—ñ—Ç—å —Ñ–æ—Ä–º—É –Ω–∏–∂—á–µ –¥–ª—è —É—á–∞—Å—Ç—ñ —É –∑–º–∞–≥–∞–Ω–Ω—è—Ö.</p>

    <form id="regForm" class="form-card" novalidate>
      <input type="text" name="hp" autocomplete="off" style="position:absolute;left:-9999px;opacity:0" />
      <input type="hidden" name="fp" id="fp" />

      <div class="field">
        <label class="form-label">–û–±–µ—Ä—ñ—Ç—å —Ç—É—Ä–Ω—ñ—Ä –∞–±–æ –µ—Ç–∞–ø *</label>
        <div class="event-options" id="eventOptions">
          <p id="loading-events">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –µ—Ç–∞–ø—ñ–≤...</p>
        </div>
      </div>

      <div class="field">
        <label for="team_name">–ù–∞–∑–≤–∞ –∫–æ–º–∞–Ω–¥–∏ *</label>
        <input id="team_name" name="team_name" type="text" required minlength="2" maxlength="60" placeholder="DK –î–≤–∞ –ö—É–º–∞" />
      </div>

      <div class="field">
        <label for="members_count">–ö—ñ–ª—å–∫—ñ—Å—Ç—å —É—á–∞—Å–Ω–∏–∫—ñ–≤ *</label>
        <input id="members_count" name="members_count" type="number" required min="1" max="4" inputmode="numeric" placeholder="1‚Äì4" />
      </div>

      <div class="field">
        <label for="captain">–ö–∞–ø—ñ—Ç–∞–Ω –∫–æ–º–∞–Ω–¥–∏ *</label>
        <input id="captain" name="captain" type="text" required minlength="2" maxlength="60" placeholder="–Ü–º‚Äô—è —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ" />
      </div>

      <div class="field">
        <label for="phone_rest">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É *</label>
        <div class="phone-wrap">
          <span class="phone-prefix">+380</span>
          <input id="phone_rest" type="text" inputmode="numeric" pattern="\d{9}" maxlength="9" required placeholder="XXXXXXXXX" aria-label="9 —Ü–∏—Ñ—Ä –ø—ñ—Å–ª—è +380" />
        </div>
        <input type="hidden" id="phone" name="phone" />
        <small class="hint">–í–≤–µ–¥—ñ—Ç—å 9 —Ü–∏—Ñ—Ä –ø—ñ—Å–ª—è +380 (—Ä–∞–∑–æ–º –±—É–¥–µ +380XXXXXXXXX)</small>
      </div>

      <fieldset class="field">
        <legend>–•–∞—Ä—á—É–≤–∞–Ω–Ω—è *</legend>
        <label class="radio"><input type="radio" name="food" value="–ù—ñ" required /> –ù—ñ</label>
        <label class="radio"><input type="radio" name="food" value="–¢–∞–∫" required /> –¢–∞–∫</label>
      </fieldset>

      <div class="field" id="foodQtyField">
        <label for="food_qty">–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ä—Ü—ñ–π</label>
        <input id="food_qty" name="food_qty" type="number" min="1" max="20" inputmode="numeric" placeholder="—Å–∫—ñ–ª—å–∫–∏ –ø–æ—Ä—Ü—ñ–π?" />
      </div>

      <div class="pay-block" style="text-align:center;margin:30px 0;">
        <h3>üí≥ –û–ø–ª–∞—Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ –≤–Ω–µ—Å–∫—É</h3>
        <p style="color:#ccc;">–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –≤–Ω–µ—Å–æ–∫: <b>1500 ‚Ç¥</b></p>

        <a href="https://send.monobank.ua/7U9RD9ypvQ?amount=1500"
           target="_blank" rel="noopener noreferrer"
           class="btn btn--primary" style="margin:8px;">
           üíú –û–ø–ª–∞—Ç–∏—Ç–∏ –≤–Ω–µ—Å–æ–∫
        </a>

        <p style="margin-top:8px;color:#aaa;font-size:0.9rem;">
          –û–ø–ª–∞—Ç–∏—Ç–∏ –º–æ–∂–Ω–∞ <b>–∑ –±—É–¥—å-—è–∫–æ–≥–æ –±–∞–Ω–∫—É</b> ‚Äî Monobank, –ü—Ä–∏–≤–∞—Ç24, –ü–£–ú–ë, –û—â–∞–¥ —Ç–æ—â–æ.
        </p>

        <div style="margin-top:18px;">
          <img
            src="https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=https%3A%2F%2Fsend.monobank.ua%2F7U9RD9ypvQ%3Famount%3D1500"
            width="180" height="180"
            alt="QR –¥–ª—è Monobank (1500 ‚Ç¥)"
            style="border-radius:10px;border:2px solid #ffcc00;box-shadow:0 0 12px rgba(255,204,0,0.4);" />
          <div style="font-size:0.9rem;color:#bbb;margin-top:8px;">–°–∫–∞–Ω—É–π—Ç–µ QR –¥–ª—è –æ–ø–ª–∞—Ç–∏</div>
        </div>

        <p style="margin-top:16px;color:#ffcc00;">
          üí° –ü—ñ–¥ —á–∞—Å –æ–ø–ª–∞—Ç–∏ –≤–ø–∏—à—ñ—Ç—å —É –∫–æ–º–µ–Ω—Ç–∞—Ä <b>–Ω–∞–∑–≤—É –≤–∞—à–æ—ó –∫–æ–º–∞–Ω–¥–∏</b>.
        </p>

        <p style="margin-top:18px;color:#aaa;">
          –ê–±–æ –≤—Ä—É—á–Ω—É –ø–µ—Ä–µ–∫–∞–∑–æ–º –Ω–∞ –∫–∞—Ä—Ç–∫—É:<br>
          <b id="cardNum" style="font-size:1.1rem;">4874&nbsp;0700&nbsp;5068&nbsp;8793</b>
        </p>

        <button id="copyCard" type="button" class="btn btn--ghost" style="margin-top:6px;">
          üìã –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç–∫–∏
        </button>
      </div>

      <div class="field checkbox">
        <label><input id="agree" name="agree" type="checkbox" required /> –ü–æ–≥–æ–¥–∂—É—é—Å—å –∑ <a href="rules.html" target="_blank" rel="noopener">—Ä–µ–≥–ª–∞–º–µ–Ω—Ç–æ–º</a> *</label>
      </div>

      <div class="form-actions">
        <button id="submitBtn" type="submit" class="btn btn--primary">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞—è–≤–∫—É</button>
        <span id="spinner" class="spinner" aria-hidden="true"></span>
      </div>

      <div id="msg" class="form-msg" role="status" aria-live="polite"></div>
    </form>
  </section>
</main>

<footer class="footer">
  <div class="container footer__row">
    <div>¬© 2025 STOLAR CARP ¬∑ –õ—å–≤—ñ–≤</div>
    <div class="footer__links">
      <a href="https://invite.viber.com/?g=8R04gUEhdVSnX6sr_DxGGGqAXTus0Ygh" rel="noopener">Viber</a>
      <a href="https://youtube.com/@dk-stolarcarp" rel="noopener">YouTube</a>
    </div>
  </div>
</footer>

<script>
// === 1. Fingerprint (–ó–∞–ª–∏—à–∞—î–º–æ —è–∫ IIFE –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è) ===
(function(){
  const src=[navigator.userAgent,navigator.language,screen.width+'x'+screen.height,Intl.DateTimeFormat().resolvedOptions().timeZone].join('|');
  let h=2166136261;
  for(let i=0;i<src.length;i++){
    h^=src.charCodeAt(i);
    h=(h*16777619)>>>0;
  }
  document.getElementById('fp').value='fp_'+h.toString(16);
})();

// === 2. –û—Å–Ω–æ–≤–Ω–∞ –ª–æ–≥—ñ–∫–∞ (–í–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DOM) ===
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('regForm');
  const qty = document.getElementById('food_qty');
  const qtyField = document.getElementById('foodQtyField');
  const phoneInput = document.getElementById('phone_rest');
  const phoneHidden = document.getElementById('phone');
  const copyCardBtn = document.getElementById('copyCard');
  const msg = document.getElementById('msg');
  const eventOptionsContainer = document.getElementById('eventOptions');
  const foodRadios = form.querySelectorAll('input[name="food"]');
  const apiUrl = 'https://script.google.com/macros/s/AKfycbyzn8QvJyZXzJneJ7e1ZGItK1-NtGE0yIOBOE6U_arFhAUYmeiwgJ2PzIDE9-lU2MMS/exec'; // –í–ê–® –ê–ö–¢–£–ê–õ–¨–ù–ò–ô API

  // --- 2.1. –õ–æ–≥—ñ–∫–∞ –¥–ª—è –∞–≤—Ç–æ–ø—Ä–µ—Ñ—ñ–ª—É (–≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –µ—Ç–∞–ø—ñ–≤) ---
  const prefillEvent = () => {
    const p = new URLSearchParams(location.search).get('event');
    if(!p) return;
    const eventRadios = eventOptionsContainer.querySelectorAll('input[name="event"]');
    const found = [...eventRadios].find(r => r.value.toLowerCase().includes(p.toLowerCase()));
    if(found){ found.checked = true; }
  };

  // --- 2.2. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –µ—Ç–∞–ø—ñ–≤ –∑ API ---
  const loadEvents = async () => {
    eventOptionsContainer.innerHTML = '<p id="loading-events">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –µ—Ç–∞–ø—ñ–≤...</p>';

    try {
      const response = await fetch(apiUrl);
      const data = await response.json(); // –û—á—ñ–∫—É—î–º–æ –º–∞—Å–∏–≤ —Ä—è–¥–∫—ñ–≤ (event_name)

      if (!Array.isArray(data) || data.length === 0) {
        eventOptionsContainer.innerHTML = '<p class="form-msg err">‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –µ—Ç–∞–ø—ñ–≤ –∞–±–æ —Å–ø–∏—Å–æ–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π.</p>';
        return;
      }

      let eventHtml = '';
      data.forEach(eventValue => {
        const icon = eventValue.toLowerCase().includes('—Ñ—ñ–Ω–∞–ª') ? 'ü•á' : 'üèÜ';
        
        eventHtml += `
          <label class="event-item">
            <input type="radio" name="event" value="${eventValue}" required>
            <span>${icon} ${eventValue}</span>
          </label>
        `;
      });

      eventOptionsContainer.innerHTML = eventHtml;

      // –í–∏–∫–ª–∏–∫–∞—î–º–æ –ª–æ–≥—ñ–∫—É –∞–≤—Ç–æ–ø—Ä–µ—Ñ—ñ–ª—É —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–Ω—Ç—É
      prefillEvent();
      
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –µ—Ç–∞–ø—ñ–≤:', error);
      eventOptionsContainer.innerHTML = '<p class="form-msg err">‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö. –°–ø—Ä–æ–±—É–π—Ç–µ –æ–Ω–æ–≤–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É.</p>';
    }
  };

  // --- 2.3. –í–∏–∫–ª–∏–∫ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ ---
  loadEvents();

  // --- 2.4. –õ–æ–≥—ñ–∫–∞ —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è ---
  const toggleFood = () => {
    const need = form.food?.value === '–¢–∞–∫';
    qty.disabled = !need;
    qty.required = need;
    qtyField.classList.toggle('field--disabled', !need);
    if (!need) {
      qty.value = '';
    }
  };

  foodRadios.forEach(r => r.addEventListener('change', toggleFood));
  toggleFood(); // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å—Ç–∞–Ω—É

  // --- 2.5. –¢–µ–ª–µ—Ñ–æ–Ω ---
  phoneInput.addEventListener('input', () => {
    const clean = (phoneInput.value || '').replace(/\D/g, '').slice(0, 9);
    phoneInput.value = clean;
    phoneHidden.value = clean.length === 9 ? '+380' + clean : '';
  });

  // --- 2.6. –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è –∫–∞—Ä—Ç–∫–∏ ---
  copyCardBtn.addEventListener('click', async () => {
    try {
      const card = document.getElementById('cardNum').textContent.replace(/\s+/g, '').trim();
      await navigator.clipboard.writeText(card);
      const old = copyCardBtn.textContent;
      copyCardBtn.textContent = '‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ';
      setTimeout(() => copyCardBtn.textContent = old, 1500);
    } catch (err) {
      alert('–°–∫–æ–ø—ñ—é–π—Ç–µ –≤—Ä—É—á–Ω—É: 4874070050688793');
    }
  });

  // --- 2.7. –°–∞–±–º—ñ—Ç —Ñ–æ—Ä–º–∏ ---
  form.addEventListener('submit', e => {
    e.preventDefault();
    msg.className = 'form-msg';
    msg.textContent = ''; 

    const selectedEvent = form.querySelector('input[name="event"]:checked')?.value || '';

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–∞–ª—ñ–¥–Ω–æ—Å—Ç—ñ —Ñ–æ—Ä–º–∏ —Ç–∞ –æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –ø–æ–ª—ñ–≤
    if (!form.checkValidity()){
        msg.className = 'form-msg err';
        msg.textContent = '–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –æ–±–æ–≤ º—è–∑–∫–æ–≤—ñ –ø–æ–ª—è.';
        form.reportValidity?.();
        return;
    }
    
    // –ï–∫—Å–ø–ª—ñ—Ü–∏—Ç–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–∏–±–æ—Ä—É –ø–æ–¥—ñ—ó (—Ö–æ—á–∞ required –º–∞—î —Å–ø—Ä–∞—Ü—é–≤–∞—Ç–∏)
    if (!selectedEvent) {
      msg.className = 'form-msg err';
      msg.textContent = '–û–±–µ—Ä—ñ—Ç—å, –±—É–¥—å –ª–∞—Å–∫–∞, –µ—Ç–∞–ø/–ø–æ–¥—ñ—é.';
      return;
    }

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç—É —Ç–µ–ª–µ—Ñ–æ–Ω—É
    if (!/^\+380\d{9}$/.test(phoneHidden.value)) {
      msg.className = 'form-msg err';
      msg.textContent = '–ù–µ–≤—ñ—Ä–Ω–∏–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É. –ü–æ—Ç—Ä—ñ–±–Ω–æ 9 —Ü–∏—Ñ—Ä –ø—ñ—Å–ª—è +380.';
      return;
    }

    // --- –£–°–ü–Ü–®–ù–ï –í–Ü–î–ü–†–ê–í–õ–ï–ù–ù–Ø (–Ü–º—ñ—Ç–∞—Ü—ñ—è) ---
    // –¢—É—Ç –º–∞—î –±—É—Ç–∏ –ª–æ–≥—ñ–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–∏—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

    // –ü–æ–∫–∞–∑–∞—Ç–∏ —É—Å–ø—ñ—à–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
    msg.className = 'form-msg ok';
    msg.innerHTML = `
      ‚úÖ –ó–∞—è–≤–∫—É –Ω–∞ <b>${selectedEvent}</b> –ø—Ä–∏–π–Ω—è—Ç–æ! –û–ø–ª–∞—Ç—ñ—Ç—å, –±—É–¥—å –ª–∞—Å–∫–∞, <b>1500 ‚Ç¥</b> —Ç–∞ –≤–∫–∞–∂—ñ—Ç—å <b>–Ω–∞–∑–≤—É –∫–æ–º–∞–Ω–¥–∏</b> —É –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –¥–æ –ø–ª–∞—Ç–µ–∂—É.<br><br>
      <span style="color:#f87171;font-weight:600;">
        ‚ö†Ô∏è –Ø–∫—â–æ –æ–ø–ª–∞—Ç–∞ –Ω–µ –±—É–¥–µ –∑–¥—ñ–π—Å–Ω–µ–Ω–∞ –ø—Ä–æ—Ç—è–≥–æ–º <b>24 –≥–æ–¥–∏–Ω</b> –ø—ñ—Å–ª—è –ø–æ–¥–∞–Ω–Ω—è –∑–∞—è–≤–∫–∏ ‚Äî –≤–æ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ <b>–∞–Ω—É–ª—é—î—Ç—å—Å—è</b>.
      </span>
    `;

    form.reset(); 
    toggleFood();
  });
});
</script>
</body>
</html>
