<!doctype html>
<html lang="uk">  
<head>  
  <meta charset="utf-8">  
  <meta name="viewport" content="width=device-width, initial-scale=1">  
  <title>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è ‚Äî STOLAR CARP</title>

  <!-- Favicon & App Icon -->
  <link rel="icon" type="image/png" href="assets/favicon.png">  
  <link rel="apple-touch-icon" href="assets/favicon.png">  
  <meta name="theme-color" content="#1a1a1a">

  <!-- –ì–æ–ª–æ–≤–Ω—ñ —Å—Ç–∏–ª—ñ —Å–∞–π—Ç—É -->
  <link rel="stylesheet" href="assets/css/main.css">  
  <script defer src="assets/js/config.js"></script>

  <!-- –õ–æ–∫–∞–ª—å–Ω—ñ —Å—Ç–∏–ª—ñ —Ç—ñ–ª—å–∫–∏ –¥–ª—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó -->
  <style>
    /* –§–æ–Ω —è–∫ –Ω–∞ —Ä–µ–π—Ç–∏–Ω–≥—É */
    body.register-page{
      background:var(--bg);
    }

    .section--narrow{
      max-width:1100px;
      margin:0 auto;
    }

    /* HERO / –∑–∞–≥–æ–ª–æ–≤–æ–∫ ‚Äî –≤ —Å—Ç–∏–ª—ñ —à–∞–ø–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥—É */
    .register-hero{
      margin-top:14px;
      margin-bottom:22px;
      padding:18px 16px 16px;
      border-radius:16px;
      background:linear-gradient(145deg,#14141d,#08080d);
      border:1px solid #262636;
      box-shadow:var(--shadow);
    }

    .register-hero__kicker{
      font-size:.72rem;
      text-transform:uppercase;
      letter-spacing:.18em;
      color:var(--muted);
      margin-bottom:6px;
      display:flex;
      align-items:center;
      gap:8px;
    }

    .register-hero__kicker-tag{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width:22px;
      height:22px;
      border-radius:999px;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      font-weight:800;
      font-size:.75rem;
      color:#000;
      box-shadow:0 0 8px rgba(0,0,0,.7);
    }

    .register-hero h1{
      margin:0 0 8px;
      font-size:clamp(22px,3.4vw,28px);
      font-weight:800;
      letter-spacing:.06em;
      text-transform:uppercase;
    }

    .register-hero h1 .strong{
      font-size:clamp(24px,3.8vw,30px);
    }

    .register-hero .title-gradient{
      background:linear-gradient(90deg,#f6c34c 0%,#cc6a2b 40%,#7a0f2b 100%);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }

    .register-hero p{
      margin:0;
      color:var(--muted);
      font-size:.92rem;
      max-width:720px;
    }

    .register-hero__divider{
      margin-top:10px;
      width:120px;
      height:2px;
      border-radius:999px;
      background:linear-gradient(90deg,#f6c34c 0%,#cc6a2b 50%,#7a0f2b 100%);
      box-shadow:0 0 10px rgba(246,195,76,.5);
    }

    /* –°—ñ—Ç–∫–∞: —Ñ–æ—Ä–º–∞ + –æ–ø–ª–∞—Ç–∞ ‚Äî —è–∫ –¥–≤—ñ –ø–∞–Ω–µ–ª—ñ —Ä–µ–π—Ç–∏–Ω–≥—É */
    .register-layout{
      display:grid;
      grid-template-columns:minmax(0,2fr) minmax(0,1.1fr);
      gap:18px;
      align-items:flex-start;
    }

    @media (max-width:860px){
      .register-layout{
        grid-template-columns:1fr;
      }
    }

    .register-form-card h2{
      margin:0 0 6px;
      font-size:1.05rem;
      text-transform:uppercase;
      letter-spacing:.08em;
    }

    .form__hint{
      font-size:.8rem;
      color:var(--muted);
    }

    /* –Ü–Ω–ø—É—Ç–∏ ‚Äî —Ç–µ–º–Ω—ñ, —è–∫ —É —Ç–∞–±–ª–∏—Ü—ñ —Ä–µ–π—Ç–∏–Ω–≥—É */
    .register-page .input,
    .register-page input[type="text"],
    .register-page input[type="tel"],
    .register-page input[type="number"]{
      background:#0f0f14 !important;
      border:1px solid #2a2a39 !important;
      color:#fff !important;
      padding:10px 14px !important;
      border-radius:10px !important;
      font-size:.96rem;
    }

    .register-page .input::placeholder,
    .register-page input::placeholder{
      color:#6b7280;
    }

    .register-page .input:focus,
    .register-page input:focus{
      outline:none;
      border-color:var(--accent) !important;
      box-shadow:0 0 6px rgba(246,195,76,0.5);
    }

    .field{
      display:grid;
      gap:6px;
      margin-bottom:12px;
    }

    .field label{
      font-size:.9rem;
      font-weight:500;
    }

    #foodQtyField.field--disabled{
      opacity:.55;
    }

    /* –í–∏–±—ñ—Ä –µ—Ç–∞–ø—É */
    .event-options{
      display:flex;
      flex-direction:column;
      gap:6px;
      padding-top:2px;
    }

    .event-item{
      display:flex;
      align-items:center;
      gap:8px;
      padding:7px 10px;
      border-radius:10px;
      background:#05060c;
      border:1px solid #262636;
      cursor:pointer;
      font-size:.9rem;
    }

    .event-item:hover{
      border-color:var(--accent);
    }

    .event-item input[type="radio"]{
      width:18px;
      height:18px;
      accent-color:#22c55e;
      flex-shrink:0;
    }

    /* –†–∞–¥—ñ–æ–∫–Ω–æ–ø–∫–∏ ¬´—Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è¬ª */
    .radio-row{
      display:flex;
      flex-wrap:wrap;
      gap:16px;
    }

    .radio-row label{
      display:inline-flex;
      align-items:center;
      gap:6px;
      cursor:pointer;
      font-size:.9rem;
    }

    /* –¢–µ–ª–µ—Ñ–æ–Ω */
    .phone-wrap{
      display:flex;
      align-items:center;
      gap:6px;
    }

    .phone-prefix{
      padding:10px 12px;
      border-radius:10px;
      background:#05060c;
      border:1px solid #262636;
      font-size:.86rem;
      color:#e5e7eb;
    }

    /* –î—ñ—ó —Ñ–æ—Ä–º–∏ */
    .form-actions{
      display:flex;
      align-items:center;
      gap:10px;
      margin-top:4px;
    }

    .spinner{
      width:18px;
      height:18px;
      border-radius:50%;
      border:3px solid rgba(255,255,255,.2);
      border-top-color:#fff;
      display:none;
    }

    .spinner--on{
      display:inline-block;
      animation:spin .9s linear infinite;
    }

    @keyframes spin{to{transform:rotate(360deg)}}

    .form-msg{
      margin-top:6px;
      font-weight:600;
      font-size:.9rem;
    }

    .form-msg.ok{color:#43d18a;}
    .form-msg.err{color:#ff6c6c;}

    /* –ö–∞—Ä—Ç–∫–∞ –æ–ø–ª–∞—Ç–∏ ‚Äî —è–∫ –±–æ–∫–æ–≤–∞ –ø–∞–Ω–µ–ª—å */
    .card--payment{
      background:#05060c;
      border:1px solid #262636;
      box-shadow:var(--shadow);
    }

    .card-payment-title{
      font-weight:600;
      margin-bottom:6px;
      display:flex;
      align-items:center;
      gap:8px;
      text-transform:uppercase;
      font-size:.84rem;
      letter-spacing:.12em;
      color:#e5e7eb;
    }

    .card-payment-title span{
      width:20px;
      height:20px;
      border-radius:50%;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size:.9rem;
      color:#000;
      font-weight:800;
    }

    .card-number{
      font-weight:600;
      letter-spacing:.16em;
      padding:8px 10px;
      border-radius:10px;
      background:#020308;
      border:1px solid #33384a;
      display:inline-block;
      margin:4px 0;
      font-size:.9rem;
    }

    .card-note{
      font-size:.8rem;
      color:var(--muted);
      margin-top:6px;
    }

    /* –ü—Ä–∏—Ö–æ–≤–∞—Ç–∏ outline —É —Ö–µ–¥–µ—Ä—ñ, —â–æ–± –Ω–µ –±—É–ª–æ –±—ñ–ª–∏—Ö —Ä–∞–º–æ–∫ */
    .header *:focus,
    .header *:focus-visible,
    .header a:focus,
    .header a:focus-visible,
    .header button:focus,
    .header button:focus-visible{
      outline:none !important;
    }
  </style>
</head>  

<body class="register-page">  

<!-- HEADER -->
<header class="header">  
  <div class="container header__row">  
    <a class="logo" href="index.html">  
      <span class="logo__mark">SC</span>  
      <span class="logo__text">STOLAR CARP</span>  
    </a>  
    <nav class="nav" id="nav">
  <a href="/index.html" class="nav__link">–ì–æ–ª–æ–≤–Ω–∞</a>
  <a href="/rules.html" class="nav__link">–†–µ–≥–ª–∞–º–µ–Ω—Ç</a>
  <a href="/register.html" class="nav__link">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
  <a href="/live.html" class="nav__link">Live</a>
  <a href="/rating.html" class="nav__link">–†–µ–π—Ç–∏–Ω–≥</a>
  <a href="/lakes.html" class="nav__link">–í–æ–¥–æ–π–º–∏</a>
  <a href="/sponsors.html" class="nav__link">–°–ø–æ–Ω—Å–æ—Ä–∏</a>
  <a href="/events/index.html" class="nav__link">–ê—Ä—Ö—ñ–≤</a>
  <a href="/cabinet.html" class="nav__link">–ú—ñ–π –∫–∞–±—ñ–Ω–µ—Ç</a>
</nav>  
    <button class="burger" id="burger"><span></span><span></span><span></span></button>  
  </div>  
</header>  

<!-- MAIN -->
<main class="main">  
  <section class="container section section--narrow">  

    <!-- HERO —É —Å—Ç–∏–ª—ñ —Ä–µ–π—Ç–∏–Ω–≥—É -->
    <div class="register-hero">
      <div class="register-hero__kicker">
        <span class="register-hero__kicker-tag">SC</span>
        SEASON 2026 ¬∑ ENTRY
      </div>
      <h1 class="title-gradient">
        <span>–†–ï–Ñ–°–¢–†–ê–¶–Ü–Ø –ù–ê –¢–£–†–ù–Ü–†</span>
        <span class="strong">STOLAR CARP 2026</span>
      </h1>
      <p>
        –ü–æ–¥–∞–π—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ —É—á–∞—Å—Ç—å —É –±–∞–≥–∞—Ç–æ–µ—Ç–∞–ø–Ω–æ–º—É —Ç—É—Ä–Ω—ñ—Ä—ñ STOLAR CARP 2026. –ü—ñ—Å–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏
        –∑–∞—è–≤–∫–∏ –∑–¥—ñ–π—Å–Ω—ñ—Ç—å –æ–ø–ª–∞—Ç—É –≤–Ω–µ—Å–∫—É —Ç–∞ –≤–∫–∞–∂—ñ—Ç—å <b>–Ω–∞–∑–≤—É –∫–æ–º–∞–Ω–¥–∏</b> —É –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –¥–æ –ø–ª–∞—Ç–µ–∂—É.
      </p>
      <div class="register-hero__divider"></div>
    </div>

    <!-- LAYOUT: —Ñ–æ—Ä–º–∞ + –æ–ø–ª–∞—Ç–∞ -->
    <div class="register-layout">

      <!-- –§–û–†–ú–ê -->
      <div class="card register-form-card">  
        <h2>–§–æ—Ä–º–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó</h2>  
        <p class="form__hint">–ü–æ–ª—è –∑ –ø–æ–∑–Ω–∞—á–∫–æ—é <span style="color:var(--accent);">*</span> —î –æ–±–æ–≤ º—è–∑–∫–æ–≤–∏–º–∏.</p>  

        <form id="regForm" class="form" novalidate>  
          <!-- honeypot (–∞–Ω—Ç–∏–±–æ—Ç) -->
          <input  
            type="text"  
            name="hp"  
            id="hp"  
            autocomplete="off"  
            style="position:absolute;left:-9999px;top:-9999px;height:0;width:0;opacity:0;"  
          />  

          <!-- fingerprint -->
          <input type="hidden" id="fp" name="fp" />  

          <!-- –ï—Ç–∞–ø -->
          <div class="field">  
            <label>  
              –û–±–µ—Ä—ñ—Ç—å –µ—Ç–∞–ø —Ç—É—Ä–Ω—ñ—Ä—É <span style="color:var(--accent);">*</span>  
            </label>  
            <div id="eventOptions" class="event-options">  
              <p id="loading-events" class="form__hint">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –µ—Ç–∞–ø—ñ–≤...</p>  
            </div>  
          </div>  

          <!-- –ù–∞–∑–≤–∞ –∫–æ–º–∞–Ω–¥–∏ (—Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è, –∑ Firebase) -->
<div class="field">  
  <label for="team_name">  
    –ù–∞–∑–≤–∞ –∫–æ–º–∞–Ω–¥–∏ <span style="color:var(--accent);">*</span>  
  </label>  
  <input  
    type="text"  
    id="team_name"  
    name="team_name"  
    class="input"  
    placeholder="–ó–∞–≤–∞–Ω—Ç–∞–∂—É—é –Ω–∞–∑–≤—É –∫–æ–º–∞–Ω–¥–∏..."  
    readonly  
    disabled  
  />  
</div>  

<!-- –ö–∞–ø—ñ—Ç–∞–Ω (—Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è) -->
<div class="field">  
  <label for="captain">  
    –ö–∞–ø—ñ—Ç–∞–Ω –∫–æ–º–∞–Ω–¥–∏ <span style="color:var(--accent);">*</span>  
  </label>  
  <input  
    type="text"  
    id="captain"  
    name="captain"  
    class="input"  
    placeholder="–ó–∞–≤–∞–Ω—Ç–∞–∂—É—é –¥–∞–Ω—ñ –∫–∞–ø—ñ—Ç–∞–Ω–∞..."  
    readonly  
    disabled  
  />  
</div>  

<!-- –¢–µ–ª–µ—Ñ–æ–Ω (—Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è) -->
<div class="field">  
  <label for="phone_rest">  
    –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É –∫–∞–ø—ñ—Ç–∞–Ω–∞ <span style="color:var(--accent);">*</span>  
  </label>  
  <div class="phone-wrap">  
    <span class="phone-prefix">+380</span>  
    <input  
      type="tel"  
      id="phone_rest"  
      inputmode="numeric"  
      placeholder="XXXXXXXXX"  
      readonly  
      disabled  
    />  
  </div>  
  <input type="hidden" id="phone" name="phone" />  
  <div class="hint" style="font-size:12px;color:var(--muted);">  
    –ù–æ–º–µ—Ä –ø—ñ–¥—Ç—è–≥–Ω–µ—Ç—å—Å—è –∑ –≤–∞—à–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é.  
  </div>  
</div>  
            <input type="hidden" id="phone" name="phone" />  
            <div class="hint" style="font-size:12px;color:var(--muted);">  
              –í–∫–∞–∑—É–π—Ç–µ –Ω–æ–º–µ—Ä –∫–∞–ø—ñ—Ç–∞–Ω–∞ –¥–ª—è –∑–≤ º—è–∑–∫—É –ø–æ —Ç—É—Ä–Ω—ñ—Ä—É.  
            </div>  
          </div>  

          <!-- –•–∞—Ä—á—É–≤–∞–Ω–Ω—è -->
          <div class="field">  
            <label>  
              –•–∞—Ä—á—É–≤–∞–Ω–Ω—è –≤—ñ–¥ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ç–æ—Ä—ñ–≤? <span style="color:var(--accent);">*</span>  
            </label>  
            <div class="radio-row">  
              <label>  
                <input type="radio" name="food" value="–¢–∞–∫" required />  
                <span>–¢–∞–∫</span>  
              </label>  
              <label>  
                <input type="radio" name="food" value="–ù—ñ" />  
                <span>–ù—ñ</span>  
              </label>  
            </div>  
          </div>  

          <!-- –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ö–∞—Ä—á—É—é—á–∏—Ö -->
          <div class="field field--disabled" id="foodQtyField">  
            <label for="food_qty">–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ö–∞—Ä—á—É—é—á–∏—Ö (1‚Äì6)</label>  
            <input  
              type="number"  
              id="food_qty"  
              name="food_qty"  
              class="input"  
              min="1"  
              max="6"  
              inputmode="numeric"  
              placeholder="–í–∫–∞–∂—ñ—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å, —è–∫—â–æ –∑–∞–º–æ–≤–ª—è—î—Ç–µ —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è"  
            />  
            <div class="hint" style="font-size:12px;color:var(--muted);">  
              –Ø–∫—â–æ —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–µ ‚Äî –∑–∞–ª–∏—à—Ç–µ –ø–æ–ª–µ –ø–æ—Ä–æ–∂–Ω—ñ–º.  
            </div>  
          </div>  

          <!-- –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—É -->
          <div class="field">  
            <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">  
              <input type="checkbox" id="rules" required style="transform:scale(1.3);accent-color:#f6c34c;">  
              <span>–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—é, —â–æ –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–∏–π —ñ–∑  
                <a href="rules.html" target="_blank" style="color:#f6c34c;text-decoration:underline;">  
                  —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–æ–º —Ç—É—Ä–Ω—ñ—Ä—É  
                </a>  
              </span>  
            </label>  
          </div>  

          <!-- –î—ñ—è -->
          <div class="form-actions">  
            <button type="submit" id="submitBtn" class="btn btn--primary">  
              –ü–æ–¥–∞—Ç–∏ –∑–∞—è–≤–∫—É  
            </button>  
            <div id="spinner" class="spinner" aria-hidden="true"></div>  
          </div>

          <!-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏ -->
          <div id="msg" class="form-msg"></div>

          <p class="form__hint" style="margin-top:6px;">  
            ‚ö†Ô∏è –ü—ñ—Å–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏ —É –≤–∞—Å —î <b>24 –≥–æ–¥–∏–Ω–∏</b>, —â–æ–± –∑–¥—ñ–π—Å–Ω–∏—Ç–∏ –æ–ø–ª–∞—Ç—É.  
            –Ø–∫—â–æ –æ–ø–ª–∞—Ç–∞ –Ω–µ –±—É–¥–µ –∑–∞—Ä–∞—Ö–æ–≤–∞–Ω–∞ ‚Äî –∑–∞—è–≤–∫–∞ –±—É–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∞–Ω—É–ª—å–æ–≤–∞–Ω–∞.  
          </p>  
        </form>  
      </div>  

      <!-- –ö–ê–†–¢–ö–ê –ó –û–ü–õ–ê–¢–û–Æ -->
      <div class="card register-card card--payment">  
        <div class="card-payment-title">  
          <span>‚Ç¥</span> –û–ø–ª–∞—Ç–∞ –≤–Ω–µ—Å–∫—É  
        </div>  
        <p>–°—É–º–∞ –≤–Ω–µ—Å–∫—É: <b>3500 ‚Ç¥</b> –Ω–∞ –±–∞–Ω–∫—ñ–≤—Å—å–∫—É –∫–∞—Ä—Ç–∫—É:</p>  
        <p>–ù–æ–º–µ—Ä –∫–∞—Ä—Ç–∫–∏:</p>
        <p>
          <span id="cardNum" class="card-number">4874 0700 5068 8793</span>
        </p>
        <button type="button" id="copyCard" class="btn btn--ghost" style="margin-top:6px;">  
          –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç–∫–∏  
        </button>  
        <p class="card-note">
          –£ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –¥–æ –ø–ª–∞—Ç–µ–∂—É –æ–±–æ–≤ º—è–∑–∫–æ–≤–æ –≤–∫–∞–∂—ñ—Ç—å <b>–Ω–∞–∑–≤—É –∫–æ–º–∞–Ω–¥–∏</b>.  
          –¶–µ –¥–æ–ø–æ–º–æ–∂–µ —à–≤–∏–¥–∫–æ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –æ–ø–ª–∞—Ç—É —Ç–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –≤–∞—à—É —É—á–∞—Å—Ç—å.
        </p>  
      </div>

    </div><!-- /register-layout -->

  </section>  
</main>  

<!-- FOOTER -->
<footer class="footer">  
  <div class="container footer__row">  
    <div>¬© 2025 STOLAR CARP ¬∑ –õ—å–≤—ñ–≤</div>  
    <div class="footer__links">  
      <a href="https://invite.viber.com/?g=8R04gUEhdVSnX6sr_DxGGGqAXTus0Ygh">Viber</a>  
      <a href="https://youtube.com/@dk-stolarcarp?si=H-BUK2msCiKXdcA9">YouTube</a>  
    </div>  
  </div>  
</footer>  

<!-- –°–ö–†–ò–ü–¢ –†–ï–Ñ–°–¢–†–ê–¶–Ü–á (–±–µ–∑ –∑–º—ñ–Ω) -->
<script>
document.addEventListener('DOMContentLoaded', () => {

  // –¢–≤–æ—è —Ä–æ–±–æ—á–∞ –≤–µ–±–∫–∞ (–∞–∫—Ç—É–∞–ª—å–Ω–∞)
  const API = "https://script.google.com/macros/s/AKfycbyyBGjueNe074tk2QXmt2QTShhW00vzrFVOsw4UB4sgQ1eMHWKCsjCr6Z4NtwQdiSaG/exec";
  const form = document.getElementById('regForm');
  const qty = document.getElementById('food_qty');
  const qtyField = document.getElementById('foodQtyField');
  const phoneInput = document.getElementById('phone_rest');
  const phoneHidden = document.getElementById('phone');
  const copyCardBtn = document.getElementById('copyCard');
  const msg = document.getElementById('msg');
  const eventOptionsContainer = document.getElementById('eventOptions');
  const submitBtn = document.getElementById('submitBtn');
  const spinner = document.getElementById('spinner');
  const fpInput = document.getElementById('fp');

  if (!form) return;

  // === Fingerprint ===
  (function makeFingerprint(){
    if (!fpInput) return;
    try {
      const src = [
        navigator.userAgent,
        navigator.language,
        (screen && (screen.width + 'x' + screen.height)) || '',
        (Intl && Intl.DateTimeFormat().resolvedOptions().timeZone) || ''
      ].join('|');

      let h = 2166136261;
      for (let i = 0; i < src.length; i++) {
        h ^= src.charCodeAt(i);
        h = (h * 16777619) >>> 0;
      }
      fpInput.value = 'fp_' + h.toString(16);
    } catch (err) {
      console.warn('Fingerprint error:', err);
    }
  })();

  // === Helpers ===
  const toggleLoading = (isLoading) => {
    submitBtn.disabled = isLoading;
    submitBtn.textContent = isLoading ? '–í—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è...' : '–ü–æ–¥–∞—Ç–∏ –∑–∞—è–≤–∫—É';
    spinner.classList.toggle('spinner--on', isLoading);
  };

  const prefillEvent = () => {
    const params = new URLSearchParams(location.search);
    const p = params.get('stage') || params.get('event');
    if (!p) return;
    const radios = eventOptionsContainer.querySelectorAll('input[name="event"]');
    const found = Array.from(radios).find(r => (r.value || '').toLowerCase().includes(p.toLowerCase()));
    if (found) found.checked = true;
  };

  // === –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –µ—Ç–∞–ø—ñ–≤ ===
  const loadEvents = async () => {
    eventOptionsContainer.innerHTML = '<p class="form__hint">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –µ—Ç–∞–ø—ñ–≤...</p>';
    toggleLoading(true);

    try {
      const response = await fetch(API);
      const data = await response.json();

      if (!Array.isArray(data) || data.length === 0) {
        eventOptionsContainer.innerHTML = '<p class="form-msg err">‚ùå –ù–µ–º–∞—î –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –µ—Ç–∞–ø—ñ–≤.</p>';
        return;
      }

      let html = '';
      data.forEach(eventValue => {
        const val = String(eventValue || '').trim();
        if (!val) return;
        const icon = val.toLowerCase().includes('—Ñ—ñ–Ω–∞–ª') ? 'ü•á' : 'üèÜ';
        html += `
          <label class="event-item">
            <input type="radio" name="event" value="${val}" required>
            <span>${icon} ${val}</span>
          </label>
        `;
      });

      eventOptionsContainer.innerHTML = html;
      prefillEvent();

    } catch (error) {
      console.error(error);
      eventOptionsContainer.innerHTML = '<p class="form-msg err">‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.</p>';
    } finally {
      toggleLoading(false);
    }
  };

  loadEvents();

  // === –•–∞—Ä—á—É–≤–∞–Ω–Ω—è ===
  const foodRadios = form.querySelectorAll('input[name="food"]');
  const toggleFood = () => {
    const need = form.food.value === '–¢–∞–∫';
    qty.disabled = !need;
    qty.required = need;
    if (!need) qty.value = '';
    qtyField.classList.toggle('field--disabled', !need);
  };

  foodRadios.forEach(r => r.addEventListener('change', toggleFood));
  toggleFood();

  // === –¢–µ–ª–µ—Ñ–æ–Ω ===
  phoneInput.addEventListener('input', () => {
    const clean = phoneInput.value.replace(/\D/g, '').slice(0, 9);
    phoneInput.value = clean;
    phoneHidden.value = clean ? '+380' + clean : '';
  });

  // === –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è –∫–∞—Ä—Ç–∫–∏ ===
  copyCardBtn.addEventListener('click', async () => {
    try {
      const num = document.getElementById('cardNum').textContent.replace(/\s+/g, '');
      await navigator.clipboard.writeText(num);
      const old = copyCardBtn.textContent;
      copyCardBtn.textContent = '‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ';
      setTimeout(() => copyCardBtn.textContent = old, 1500);
    } catch {
      alert('–°–∫–æ–ø—ñ—é–π—Ç–µ –≤—Ä—É—á–Ω—É.');
    }
  });

  // === –°–∞–±–º—ñ—Ç ===
  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    if (!form.checkValidity()) {
      msg.className = 'form-msg err';
      msg.textContent = '–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è.';
      form.reportValidity();
      return;
    }

    if (!/^\+380\d{9}$/.test(phoneHidden.value)) {
      msg.className = 'form-msg err';
      msg.textContent = '–ù–µ–≤—ñ—Ä–Ω–∏–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É.';
      return;
    }

    toggleLoading(true);

    try {
      const formData = new FormData(form);
      const response = await fetch(API, { method: 'POST', body: formData });
      const result = await response.json();

      if (result.success) {
        msg.className = 'form-msg ok';
        msg.innerHTML = `‚úÖ –ó–∞—è–≤–∫—É –Ω–∞ <b>${formData.get('event')}</b> –ø—Ä–∏–π–Ω—è—Ç–æ!`;
        form.reset();
        phoneHidden.value = '';
        toggleFood();
      } else {
        msg.className = 'form-msg err';
        msg.textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞ –∑ –±–æ–∫—É —Å–µ—Ä–≤–µ—Ä–∞.';
      }

    } catch (err) {
      msg.className = 'form-msg err';
      msg.textContent = '‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –∑ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è–º.';
    } finally {
      toggleLoading(false);
    }
  });

});
</script>

</body>  
</html>
