<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è ‚Äî STOLAR CARP</title>

  <!-- Favicon & App Icon -->
  <link rel="icon" type="image/png" href="assets/favicon.png">
  <link rel="apple-touch-icon" href="assets/favicon.png">
  <meta name="theme-color" content="#1a1a1a">

  <!-- –°—Ç–∏–ª—ñ —Ç–∞ —Å–∫—Ä–∏–ø—Ç –º–µ–Ω—é -->
  <link rel="stylesheet" href="assets/css/main.css">
  <script defer src="assets/js/config.js"></script>

  <!-- –õ–æ–∫–∞–ª—å–Ω—ñ —Å—Ç–∏–ª—ñ —Ç—ñ–ª—å–∫–∏ –¥–ª—è —Ü—ñ—î—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ -->
  <style>
    .register-intro {
      margin-bottom: 20px;
      text-align: center;
      position: relative;
    }

    .register-card {
      margin-top: 18px;
      margin-bottom: 16px;
    }

    .register-form-card {
      margin-top: 10px;
    }

    .event-options {
      display: flex;
      flex-direction: column;
      gap: 6px;
      padding-top: 4px;
    }

    .event-item {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 9px;
      border-radius: 10px;
      background: #0d0d14;
      border: 1px solid #262636;
      cursor: pointer;
      font-size: 0.95rem;
    }

    .event-item:hover {
      border-color: rgba(250, 204, 21, 0.8);
    }

    /* –∑–µ–ª–µ–Ω–∞ –±—ñ–ª—å—à–∞ –∫—Ä–∞–ø–∫–∞ –≤–∏–±–æ—Ä—É –µ—Ç–∞–ø—É */
    .event-item input[type="radio"] {
      width: 20px;
      height: 20px;
      accent-color: #22c55e; /* –∑–µ–ª–µ–Ω–∏–π */
      transform: scale(1.15);
    }

    .radio-row {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }

    .radio-row label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    #foodQtyField.field--disabled {
      opacity: 0.55;
    }

    /* –°—Ç–∏–ª—å –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
    .page-title span {
      display: block;
    }

    .page-title span:nth-child(1),
    .page-title span:nth-child(2) {
      font-size: clamp(26px,4vw,32px);
      text-transform: uppercase;
      letter-spacing: .08em;
    }

    .page-title span:nth-child(3) {
      font-size: clamp(30px,4.6vw,40px);
      font-weight: 900;
    }

    /* –ì—Ä–∞–¥—ñ—î–Ω—Ç + glow + –ª–µ–≥–∫–µ "–¥–∏—Ö–∞–Ω–Ω—è" */
    .register-page .page-title.title-gradient {
      animation: scGlowPulse 3.6s ease-in-out infinite;
      text-shadow:
        0 0 10px rgba(246,195,76,0.55),
        0 0 22px rgba(122,15,43,0.55),
        0 0 40px rgba(0,0,0,0.8);
      margin-bottom: 4px;
    }

    @keyframes scGlowPulse {
      0% {
        text-shadow:
          0 0 6px rgba(246,195,76,0.35),
          0 0 16px rgba(122,15,43,0.35),
          0 0 30px rgba(0,0,0,0.6);
        transform: translateY(0);
      }
      50% {
        text-shadow:
          0 0 14px rgba(246,195,76,0.85),
          0 0 30px rgba(122,15,43,0.85),
          0 0 46px rgba(0,0,0,0.9);
        transform: translateY(-1px);
      }
      100% {
        text-shadow:
          0 0 6px rgba(246,195,76,0.35),
          0 0 16px rgba(122,15,43,0.35),
          0 0 30px rgba(0,0,0,0.6);
        transform: translateY(0);
      }
    }

    /* –¢–æ–Ω–∫–∞ –ª—ñ–Ω—ñ—è –ø—ñ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º */
    .register-intro::after {
      content: "";
      display: block;
      margin: 14px auto 0;
      width: 120px;
      height: 2px;
      border-radius: 999px;
      background: linear-gradient(90deg,#f6c34c 0%,#cc6a2b 50%,#7a0f2b 100%);
      box-shadow: 0 0 12px rgba(246,195,76,0.6);
      opacity: .9;
    }

    @media (max-width: 520px) {
      .register-intro::after {
        width: 90px;
      }
    }

    /* –¢–µ–º–Ω—ñ, –ø—Ä–µ–º—ñ–∞–ª—å–Ω—ñ —ñ–Ω–ø—É—Ç–∏ –Ω–∞ —Ü—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ */
    .register-page .input,
    .register-page input[type="text"],
    .register-page input[type="tel"],
    .register-page input[type="number"] {
      background: #0f0f14 !important;
      border: 1px solid #2a2a39 !important;
      color: #fff !important;
      padding: 10px 14px !important;
      border-radius: 10px !important;
      font-size: 1rem;
    }

    .register-page .input::placeholder,
    .register-page input::placeholder {
      color: #6b7280;
    }

    .register-page .input:focus,
    .register-page input:focus {
      outline: none;
      border-color: #f6c34c !important;
      box-shadow: 0 0 6px rgba(246,195,76,0.5);
    }
  </style>
</head>
<body class="register-page">

<!-- HEADER -->
<header class="header">
  <div class="container header__row">
    <a class="logo" href="index.html">
      <span class="logo__mark">SC</span>
      <span class="logo__text">STOLAR CARP</span>
    </a>
    <nav class="nav" id="nav">
      <a href="index.html" class="nav__link">–ì–æ–ª–æ–≤–Ω–∞</a>
      <a href="rules.html" class="nav__link">–†–µ–≥–ª–∞–º–µ–Ω—Ç</a>
      <a href="register.html" class="nav__link nav__link--active">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
      <a href="live.html" class="nav__link">Live</a>
      <a href="rating.html" class="nav__link">–†–µ–π—Ç–∏–Ω–≥</a>
      <a href="lakes.html" class="nav__link">–í–æ–¥–æ–π–º–∏</a>
      <a href="sponsors.html" class="nav__link">–°–ø–æ–Ω—Å–æ—Ä–∏</a>
      <a href="events/turnir-2026.html" class="nav__link">–¢—É—Ä–Ω—ñ—Ä 2026</a>
    </nav>
    <button class="burger" id="burger"><span></span><span></span><span></span></button>
  </div>
</header>

<!-- MAIN -->
<main class="main">
  <section class="container section section--narrow">
    <div class="register-intro">
      <h1 class="page-title title-gradient">
        <span>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</span>
        <span>–¢—É—Ä–Ω—ñ—Ä</span>
        <span>STOLAR CARP 2026</span>
      </h1>
      <p class="lead">
        –ü–æ–¥–∞–π—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ —É—á–∞—Å—Ç—å —É —Ç—É—Ä–Ω—ñ—Ä—ñ STOLAR CARP 2026. –ü—ñ—Å–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏ –∑–¥—ñ–π—Å–Ω—ñ—Ç—å –æ–ø–ª–∞—Ç—É
        —Ç–∞ –≤–∫–∞–∂—ñ—Ç—å <b>–Ω–∞–∑–≤—É –∫–æ–º–∞–Ω–¥–∏</b> —É –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –¥–æ –ø–ª–∞—Ç–µ–∂—É.
      </p>
    </div>

    <!-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏ -->
    <div id="msg" class="form-msg"></div>

    <!-- –§–æ—Ä–º–∞ -->
    <div class="form-card register-form-card">
      <h2>–§–æ—Ä–º–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó</h2>
      <p class="form__hint">–ü–æ–ª—è –∑ –ø–æ–∑–Ω–∞—á–∫–æ—é <span style="color:var(--accent);">*</span> —î –æ–±–æ–≤ º—è–∑–∫–æ–≤–∏–º–∏.</p>

      <form id="regForm" class="form" novalidate>
        <!-- honeypot (–∞–Ω—Ç–∏–±–æ—Ç) -->
        <input
          type="text"
          name="hp"
          id="hp"
          autocomplete="off"
          style="position:absolute;left:-9999px;top:-9999px;height:0;width:0;opacity:0;"
        />

        <!-- fingerprint -->
        <input type="hidden" id="fp" name="fp" />

        <!-- –ï—Ç–∞–ø -->
        <div class="field">
          <label>
            –û–±–µ—Ä—ñ—Ç—å –µ—Ç–∞–ø —Ç—É—Ä–Ω—ñ—Ä—É <span style="color:var(--accent);">*</span>
          </label>
          <div id="eventOptions" class="event-options">
            <p id="loading-events" class="form__hint">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –µ—Ç–∞–ø—ñ–≤...</p>
          </div>
        </div>

        <!-- –ù–∞–∑–≤–∞ –∫–æ–º–∞–Ω–¥–∏ -->
        <div class="field">
          <label for="team_name">
            –ù–∞–∑–≤–∞ –∫–æ–º–∞–Ω–¥–∏ <span style="color:var(--accent);">*</span>
          </label>
          <input
            type="text"
            id="team_name"
            name="team_name"
            class="input"
            required
            minlength="2"
            maxlength="100"
            placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –∫–æ–º–∞–Ω–¥–∏"
          />
        </div>

        <!-- –ö–∞–ø—ñ—Ç–∞–Ω -->
        <div class="field">
          <label for="captain">
            –ö–∞–ø—ñ—Ç–∞–Ω –∫–æ–º–∞–Ω–¥–∏ <span style="color:var(--accent);">*</span>
          </label>
          <input
            type="text"
            id="captain"
            name="captain"
            class="input"
            required
            minlength="2"
            maxlength="100"
            placeholder="–Ü–º'—è —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ –∫–∞–ø—ñ—Ç–∞–Ω–∞"
          />
        </div>

        <!-- –¢–µ–ª–µ—Ñ–æ–Ω -->
        <div class="field">
          <label for="phone_rest">
            –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É (—Ñ–æ—Ä–º–∞—Ç: +380XXXXXXXXX) <span style="color:var(--accent);">*</span>
          </label>
          <div class="phone-wrap">
            <span class="phone-prefix">+380</span>
            <input
              type="tel"
              id="phone_rest"
              inputmode="numeric"
              placeholder="XXXXXXXXX"
              required
            />
          </div>
          <input type="hidden" id="phone" name="phone" />
          <div class="hint" style="font-size:12px;color:var(--muted);">
            –í–∫–∞–∑—É–π—Ç–µ –Ω–æ–º–µ—Ä –∫–∞–ø—ñ—Ç–∞–Ω–∞ –¥–ª—è –∑–≤ º—è–∑–∫—É –ø–æ —Ç—É—Ä–Ω—ñ—Ä—É.
          </div>
        </div>

        <!-- –•–∞—Ä—á—É–≤–∞–Ω–Ω—è -->
        <div class="field">
          <label>
            –•–∞—Ä—á—É–≤–∞–Ω–Ω—è –≤—ñ–¥ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ç–æ—Ä—ñ–≤? <span style="color:var(--accent);">*</span>
          </label>
          <div class="radio-row">
            <label>
              <input type="radio" name="food" value="–¢–∞–∫" required />
              <span>–¢–∞–∫</span>
            </label>
            <label>
              <input type="radio" name="food" value="–ù—ñ" />
              <span>–ù—ñ</span>
            </label>
          </div>
        </div>

        <!-- –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ö–∞—Ä—á—É—é—á–∏—Ö -->
        <div class="field field--disabled" id="foodQtyField">
          <label for="food_qty">–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ö–∞—Ä—á—É—é—á–∏—Ö (1‚Äì6)</label>
          <input
            type="number"
            id="food_qty"
            name="food_qty"
            class="input"
            min="1"
            max="6"
            inputmode="numeric"
            placeholder="–í–∫–∞–∂—ñ—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å, —è–∫—â–æ –∑–∞–º–æ–≤–ª—è—î—Ç–µ —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è"
          />
          <div class="hint" style="font-size:12px;color:var(--muted);">
            –Ø–∫—â–æ —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–µ ‚Äî –∑–∞–ª–∏—à—Ç–µ –ø–æ–ª–µ –ø–æ—Ä–æ–∂–Ω—ñ–º.
          </div>
        </div>

        <!-- –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—É -->
        <div class="field">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="rules" required style="transform:scale(1.3);accent-color:#f6c34c;">
            <span>–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—é, —â–æ –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–∏–π —ñ–∑
              <a href="rules.html" target="_blank" style="color:#f6c34c;text-decoration:underline;">
                —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–æ–º —Ç—É—Ä–Ω—ñ—Ä—É
              </a>
            </span>
          </label>
        </div>

        <!-- –î—ñ—è -->
        <div class="form-actions">
          <button type="submit" id="submitBtn" class="btn btn--primary">
            –ü–æ–¥–∞—Ç–∏ –∑–∞—è–≤–∫—É
          </button>
          <div id="spinner" class="spinner" aria-hidden="true"></div>
        </div>

        <p class="form__hint" style="margin-top:6px;">
          ‚ö†Ô∏è –ü—ñ—Å–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏ —É –≤–∞—Å —î <b>24 –≥–æ–¥–∏–Ω–∏</b>, —â–æ–± –∑–¥—ñ–π—Å–Ω–∏—Ç–∏ –æ–ø–ª–∞—Ç—É.
          –Ø–∫—â–æ –æ–ø–ª–∞—Ç–∞ –Ω–µ –±—É–¥–µ –∑–∞—Ä–∞—Ö–æ–≤–∞–Ω–∞ ‚Äî –∑–∞—è–≤–∫–∞ –±—É–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∞–Ω—É–ª—å–æ–≤–∞–Ω–∞.
        </p>
      </form>
    </div>

    <!-- –ö–∞—Ä—Ç–∫–∞ –∑ –æ–ø–ª–∞—Ç–æ—é (–Ω–∏–∂—á–µ —Ñ–æ—Ä–º–∏) -->
    <div class="card register-card">
      <div class="card-payment-title" style="font-weight:600;margin-bottom:4px;">
        –û–ø–ª–∞—Ç–∞ –≤–Ω–µ—Å–∫—É
      </div>
      <p>–°—É–º–∞ –≤–Ω–µ—Å–∫—É: <b>3500 ‚Ç¥</b> –Ω–∞ –∫–∞—Ä—Ç–∫—É</p>
      <p>–ù–æ–º–µ—Ä –∫–∞—Ä—Ç–∫–∏: <span id="cardNum" class="card-number" style="font-weight:600;letter-spacing:0.12em;">4874 0700 5068 8793</span></p>
      <button type="button" id="copyCard" class="btn btn--ghost" style="margin-top:6px;">
        –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –∫–∞—Ä—Ç–∫—É
      </button>
      <p class="form__hint">–£ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –¥–æ –ø–ª–∞—Ç–µ–∂—É –æ–±–æ–≤ º—è–∑–∫–æ–≤–æ –≤–∫–∞–∂—ñ—Ç—å <b>–Ω–∞–∑–≤—É –∫–æ–º–∞–Ω–¥–∏</b>.</p>
    </div>

  </section>
</main>

<!-- FOOTER -->
<footer class="footer">
  <div class="container footer__row">
    <div>¬© 2025 STOLAR CARP ¬∑ –õ—å–≤—ñ–≤</div>
    <div class="footer__links">
      <a href="https://invite.viber.com/?g=8R04gUEhdVSnX6sr_DxGGGqAXTus0Ygh">Viber</a>
      <a href="https://youtube.com/@dk-stolarcarp?si=H-BUK2msCiKXdcA9">YouTube</a>
    </div>
  </div>
</footer>

<!-- –°–ö–†–ò–ü–¢ –†–ï–Ñ–°–¢–†–ê–¶–Ü–á -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const API_URL = "https://script.google.com/macros/s/AKfycbzBnlHIIG_VzI6DOzSOLYGOeHET8qi8jc-EK1ar1NAVa8zVKiT2U1IZ80GIf1d2NL0S/exec";
  const form = document.getElementById('regForm');
  const qty = document.getElementById('food_qty');
  const qtyField = document.getElementById('foodQtyField');
  const phoneInput = document.getElementById('phone_rest');
  const phoneHidden = document.getElementById('phone');
  const copyCardBtn = document.getElementById('copyCard');
  const msg = document.getElementById('msg');
  const eventOptionsContainer = document.getElementById('eventOptions');
  const submitBtn = document.getElementById('submitBtn');
  const spinner = document.getElementById('spinner');
  const fpInput = document.getElementById('fp');

  if (!form) return;

  // === Fingerprint ===
  (function makeFingerprint(){
    if (!fpInput) return;
    try {
      const src = [
        navigator.userAgent,
        navigator.language,
        (screen && (screen.width + 'x' + screen.height)) || '',
        (Intl && Intl.DateTimeFormat().resolvedOptions().timeZone) || ''
      ].join('|');

      let h = 2166136261;
      for (let i = 0; i < src.length; i++) {
        h ^= src.charCodeAt(i);
        h = (h * 16777619) >>> 0;
      }
      fpInput.value = 'fp_' + h.toString(16);
    } catch (err) {
      console.warn('Fingerprint error:', err);
    }
  })();

  // === Helpers ===
  const toggleLoading = (isLoading) => {
    if (submitBtn) {
      submitBtn.disabled = isLoading;
      submitBtn.textContent = isLoading ? '–í—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è...' : '–ü–æ–¥–∞—Ç–∏ –∑–∞—è–≤–∫—É';
    }
    if (spinner) {
      spinner.classList.toggle('spinner--on', isLoading);
    }
  };

  const prefillEvent = () => {
    if (!eventOptionsContainer) return;
    const params = new URLSearchParams(location.search);
    const p = params.get('stage') || params.get('event');
    if (!p) return;
    const radios = eventOptionsContainer.querySelectorAll('input[name="event"]');
    const found = Array.from(radios).find(r => (r.value || '').toLowerCase().includes(p.toLowerCase()));
    if (found) found.checked = true;
  };

  // === –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –µ—Ç–∞–ø—ñ–≤ ===
  const loadEvents = async () => {
    if (!eventOptionsContainer) return;
    eventOptionsContainer.innerHTML = '<p id="loading-events" class="form__hint">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –µ—Ç–∞–ø—ñ–≤...</p>';
    toggleLoading(true);

    try {
      const response = await fetch(API_URL);
      const data = await response.json();

      if (!Array.isArray(data) || data.length === 0) {
        eventOptionsContainer.innerHTML = '<p class="form-msg err" style="display:block;">‚ùå –ù–µ–º–∞—î –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –µ—Ç–∞–ø—ñ–≤ –∞–±–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è —ó—Ö –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏.</p>';
        return;
      }

      let html = '';
      data.forEach(eventValue => {
        const val = String(eventValue || '').trim();
        if (!val) return;
        const icon = val.toLowerCase().includes('—Ñ—ñ–Ω–∞–ª') ? 'ü•á' : 'üèÜ';
        html += `
          <label class="event-item">
            <input type="radio" name="event" value="${val}" required>
            <span>${icon} ${val}</span>
          </label>
        `;
      });

      eventOptionsContainer.innerHTML = html || '<p class="form-msg err" style="display:block;">‚ùå –ù–µ–º–∞—î –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –µ—Ç–∞–ø—ñ–≤ –¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó.</p>';
      prefillEvent();

    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –µ—Ç–∞–ø—ñ–≤:', error);
      eventOptionsContainer.innerHTML = '<p class="form-msg err" style="display:block;">‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –¥–∞–Ω–∏—Ö. –û–Ω–æ–≤—ñ—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É –∞–±–æ —Å–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.</p>';
    } finally {
      toggleLoading(false);
    }
  };

  loadEvents();

  // === –õ–æ–≥—ñ–∫–∞ —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è ===
  const foodRadios = form.querySelectorAll('input[name="food"]');
  const toggleFood = () => {
    const need = form.food && form.food.value === '–¢–∞–∫';
    if (qty) {
      qty.disabled = !need;
      qty.required = need;
      if (!need) qty.value = '';
    }
    if (qtyField) {
      qtyField.classList.toggle('field--disabled', !need);
    }
  };

  foodRadios.forEach(r => r.addEventListener('change', toggleFood));
  toggleFood();

  // === –¢–µ–ª–µ—Ñ–æ–Ω ===
  if (phoneInput && phoneHidden) {
    phoneInput.addEventListener('input', () => {
      const clean = (phoneInput.value || '').replace(/\D/g, '').slice(0, 9);
      phoneInput.value = clean;
      phoneHidden.value = clean ? ('+380' + clean) : '';
    });
  }

  // === –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è –∫–∞—Ä—Ç–∫–∏ ===
  if (copyCardBtn) {
    copyCardBtn.addEventListener('click', async () => {
      try {
        const cardEl = document.getElementById('cardNum');
        const num = (cardEl?.textContent || '').replace(/\s+/g, '').trim() || '4874070050688793';
        await navigator.clipboard.writeText(num);
        const old = copyCardBtn.textContent;
        copyCardBtn.textContent = '‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ';
        setTimeout(() => copyCardBtn.textContent = old, 1500);
      } catch (err) {
        alert('–°–∫–æ–ø—ñ—é–π—Ç–µ –≤—Ä—É—á–Ω—É: 4874070050688793');
      }
    });
  }

  // === –°–∞–±–º—ñ—Ç ===
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    if (msg) {
      msg.className = 'form-msg';
      msg.textContent = '';
    }

    if (!form.checkValidity()) {
      if (msg) {
        msg.className = 'form-msg err';
        msg.textContent = '–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –æ–±–æ–≤ º—è–∑–∫–æ–≤—ñ –ø–æ–ª—è.';
      }
      form.reportValidity?.();
      return;
    }

    if (phoneHidden && !/^\+380\d{9}$/.test(phoneHidden.value || '')) {
      if (msg) {
        msg.className = 'form-msg err';
        msg.textContent = '–ù–µ–≤—ñ—Ä–Ω–∏–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É. –ü–æ—Ç—Ä—ñ–±–Ω–æ 9 —Ü–∏—Ñ—Ä –ø—ñ—Å–ª—è +380.';
      }
      return;
    }

    toggleLoading(true);

    try {
      const formData = new FormData(form);

      const response = await fetch(API_URL, {
        method: 'POST',
        body: formData
      });

      const result = await response.json();

      if (result && result.success) {
        const selectedStage = formData.get('event') || '–æ–±—Ä–∞–Ω–∏–π –µ—Ç–∞–ø';

        if (msg) {
          msg.className = 'form-msg ok';
          msg.innerHTML = `
            ‚úÖ –ó–∞—è–≤–∫—É –Ω–∞ <b>${selectedStage}</b> –ø—Ä–∏–π–Ω—è—Ç–æ! –û–ø–ª–∞—Ç—ñ—Ç—å, –±—É–¥—å –ª–∞—Å–∫–∞, <b>3500 ‚Ç¥</b> —Ç–∞ –≤–∫–∞–∂—ñ—Ç—å <b>–Ω–∞–∑–≤—É –∫–æ–º–∞–Ω–¥–∏</b> —É –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –¥–æ –ø–ª–∞—Ç–µ–∂—É.<br><br>
            <span style="color:#f97373;font-weight:600;">
              ‚ö†Ô∏è –Ø–∫—â–æ –æ–ø–ª–∞—Ç–∞ –Ω–µ –±—É–¥–µ –∑–¥—ñ–π—Å–Ω–µ–Ω–∞ –ø—Ä–æ—Ç—è–≥–æ–º <b>24 –≥–æ–¥–∏–Ω</b> –ø—ñ—Å–ª—è –ø–æ–¥–∞–Ω–Ω—è –∑–∞—è–≤–∫–∏ ‚Äî –≤–æ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ <b>–∞–Ω—É–ª—é—î—Ç—å—Å—è</b>.
            </span>
          `;
        }

        form.reset();
        if (phoneHidden) phoneHidden.value = '';
        toggleFood();

      } else {
        console.error('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏:', result);
        if (msg) {
          msg.className = 'form-msg err';
          msg.textContent = `‚ùå –ü–æ–º–∏–ª–∫–∞: ${result?.error || '–ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –¥–∞–Ω—ñ. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.'}`;
        }
      }
    } catch (error) {
      console.error('Fetch error:', error);
      if (msg) {
        msg.className = 'form-msg err';
        msg.textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞ –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è —ñ–∑ —Å–µ—Ä–≤–µ—Ä–æ–º. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç –∞–±–æ —Å–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.';
      }
    } finally {
      toggleLoading(false);
    }
  });
});
</script>

</body>
</html>
